(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b784720","chunk-2d0c0653","chunk-2d0c4e43"],{"3d84":function(e,t,i){"use strict";i.r(t),i.d(t,"crudOptions",(function(){return o}));i("a161");var o=function(e){return{options:{height:"100%"},searchOptions:{},rowHandle:{width:280,view:{show:!1},custom:[{thin:!0,text:"下载视频",type:"info",size:"small",emit:"download",icon:"el-icon-download"}]},columns:[{title:"id",key:"id",show:!1,form:{disabled:!0}},{title:"视频名称",key:"sort",search:{disabled:!1}},{title:"训练视频",key:"file",show:!1,editForm:{component:{show:!1}},addForm:{component:{show:!0}}},{title:"上传时间",key:"uploadTime",sortable:!0,type:"datetime"}]}}},4232:function(e,t,i){"use strict";i.r(t),i.d(t,"GetVideoList",(function(){return r})),i.d(t,"UpdateVideo",(function(){return a})),i.d(t,"DelVideo",(function(){return d}));var o=i("22ce");function r(e,t){return null==t?Object(o["a"])({url:"/teacher/page4VideoList",method:"post",data:e}):Object(o["a"])({url:"/teacher/findTranVideos",method:"post",data:e,sort:t})}function a(e,t){return Object(o["a"])({url:"/teacher/updateVideo",method:"post",data:{id:t,sort:e.sort,fileName:e.fileName,savePath:e.savePath,uploadTime:e.uploadTime}})}function d(e){return Object(o["a"])({url:"/teacher/deleteVideo/"+e,method:"DELETE",data:{id:e}})}},"639c":function(e,t,i){},"8b2a":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("d2-container",{class:{"page-compact":e.crud.pageOptions.compact}},[i("d2-crud-x",e._g(e._b({ref:"d2Crud",attrs:{"add-rules":e.addRules,"edit-rules":e.editRules},on:{download:e.handleDownload}},"d2-crud-x",e._crudProps,!1),e._crudListeners),[i("div",{attrs:{slot:"header"},slot:"header"},[i("crud-search",{ref:"search",attrs:{options:e.crud.searchOptions},on:{submit:e.handleSearch}}),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.addNewVideoDialogVisible=!0}}},[i("i",{staticClass:"el-icon-plus"}),e._v("新增训练视频 ")]),i("el-dialog",{attrs:{title:"新增训练视频信息",visible:e.addNewVideoDialogVisible,width:"50vw","before-close":e.cancelSubmit},on:{"update:visible":function(t){e.addNewVideoDialogVisible=t}}},[i("div",[i("el-form",{ref:"editVideoProp",attrs:{model:e.editVideoProp,rules:e.newRules,"label-width":"10vw"}},[i("el-form-item",{attrs:{label:"视频名称",prop:"sort"}},[i("el-input",{model:{value:e.editVideoProp.sort,callback:function(t){e.$set(e.editVideoProp,"sort",t)},expression:"editVideoProp.sort"}})],1),i("el-form-item",[i("el-upload",{ref:"uploadVideo",staticClass:"upload-demo",attrs:{drag:"",action:"/teacher/fileupload",data:e.uploadData,"auto-upload":!1,multiple:!1,accept:".mp4",limit:1}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击上传")])])])],1),i("el-form-item",[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitVideoPropForm("editVideoProp")}}},[e._v("立即上传")]),i("el-button",{attrs:{size:"small"},on:{click:e.cancelSubmit}},[e._v("取消")])],1)],1)],1)]),i("el-dialog",{attrs:{title:"训练视频预览",visible:e.videoDisplayDialogVisible,width:"50vw"},on:{"update:visible":function(t){e.videoDisplayDialogVisible=t},"before-close":function(t){e.videoDisplayDialogVisible=!1}}},[i("video-player",{ref:"videoPlayer",staticClass:"video-player vjs-custom-skin",attrs:{playsinline:!0,options:e.playerOptions}})],1),i("crud-toolbar",e._g(e._b({attrs:{search:null,compact:e.crud.pageOptions.compact,columns:e.crud.columns},on:{"update:compact":function(t){return e.$set(e.crud.pageOptions,"compact",t)},refresh:function(t){return e.doRefresh()},"columns-filter-changed":e.handleColumnsFilterChanged}},"crud-toolbar",e._crudToolbarProps,!1),e._crudToolbarListeners))],1)])],1)},r=[],a=(i("c975"),i("3d84")),d=i("1fbf"),s=i("4232"),l=i("a18c"),n=i("d6d3"),u={name:"non-equipmentVideo",components:{videoPlayer:n["videoPlayer"]},mixins:[d["d2CrudPlus"].crud],data:function(){return{playerOptions:{playbackRates:[.7,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"video/mp4",src:""}],notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}},videoDisplayDialogVisible:!1,addRules:{sort:[{required:!0,message:"请输入视频名称",trigger:"blur"}],uploadTime:[{required:!0,message:"请选择上传时间",trigger:"blur"}]},editRules:{sort:[{required:!0,message:"请输入视频名称",trigger:"blur"}],uploadTime:[{required:!0,message:"请选择上传时间",trigger:"blur"}]},addNewVideoDialogVisible:!1,editVideoProp:{id:"",sort:"",fileName:"",savePath:"",uploadTime:""},newRules:{sort:[{required:!0,message:"请输入视频名称",trigger:"blur"},{min:2,max:18,message:"长度在 3 到 18 个字符",trigger:"blur"}]}}},methods:{displayVideo:function(e){this.videoDisplayDialogVisible=!0,this.playerOptions.sources[0].src="/teacher/filedownload/".concat(e.id)},handleCurrentChange:function(e,t){this.displayVideo(e)},getCrudOptions:function(){return Object(a["crudOptions"])(this)},pageRequest:function(e){return Object(s["GetVideoList"])(e,this.crud.searchOptions.form.sort)},updateRequest:function(e){return Object(s["UpdateVideo"])(e,e.id)},delRequest:function(e){return Object(s["DelVideo"])(e.id)},handleDownload:function(e){this.$axios.get("/teacher/filedownload/"+e.row.id);var t=window.document.location.href,i=l["a"].path,o=t.indexOf(i),r=t.substring(0,o-2),a=r+"/teacher/filedownload/"+e.row.id;window.open(a),this.$message.success("下载成功！")},myAddRow:function(){},submitVideoPropForm:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.$refs.uploadVideo.submit(),t.addNewVideoDialogVisible=!1)}))},cancelSubmit:function(){this.addNewVideoDialogVisible=!1,this.resetEditVideoProp()},resetEditVideoProp:function(){this.editVideoProp.id="",this.editVideoProp.sort="",this.editVideoProp.fileName="",this.editVideoProp.savePath="",this.editVideoProp.uploadTime=""}},computed:{uploadData:function(){return{fileName:this.editVideoProp.sort,sort:this.editVideoProp.sort}}}},c=u,p=(i("917f"),i("2877")),m=Object(p["a"])(c,o,r,!1,null,null,null);t["default"]=m.exports},"917f":function(e,t,i){"use strict";var o=i("639c"),r=i.n(o);r.a}}]);